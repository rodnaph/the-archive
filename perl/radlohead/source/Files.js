///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files.js
//
///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////

var Folders;
var Files_RootTagId='FilesRootTag';
var FilesDoc=null;
var Images=null;
var FolderView=parent.frames[0];

//
//  init...
//

var tag=(Browser.nn4)?'layer':'div';
document.writeln('<'+tag+' id="'+Files_RootTagId+'">Loading...</'+tag+'>');
self.onload=Files_setup;

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  showFolder()
//
///////////////////////////////////////////////////////////////////////////////////////////////

function showFolder(objFolder,index,isRoot){
 FilesDoc.clear();
 var content='<table cellpadding="0" cellspacing="0" border="0">';
 for(var i in objFolder.folders){
  var obj=objFolder.folders[i];
  var action=(isRoot)?'javascript:FolderView.RootDrive.obj.folders['+i+'].view('+obj.index+')'
                     :'javascript:Files_showFolder('+index+',\''+obj.id+'\')';
  var fldimg=(obj.bin)?'bin':'folder';
  content+='<tr><td>';
  content+=Images.getImage(fldimg+'.gif').link(action);
  content+='</td><td valign="bottom"><a href="'+action+'"><span class="Folder">'+obj.name+'</span></a></td></tr>'
 }
 if(!objFolder.secure){
  for(var i in objFolder.files){
   var obj=objFolder.files[i];
   var path='javascript:Files_viewFile(\''+obj.directory+'/'+obj.name+'\')';
   content+='<tr><td>'+FileTypes.getImage(obj.type).link(path)+'</td><td valign="bottom">';
   content+='<span class="Folder">'+obj.name.link(path)+'</span></td></tr>'
  }
  content+='</table>'
 }else{
  content+='</table><br /><i>Secure Folder, No Files Visible</i>'
 }
 FilesDoc.append(content);
 FilesDoc.close();
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files_viewFile(file)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function Files_viewFile(file){
 window.open('view.pl?file='+escape(file),'downloadWin','scrollbars=yes,toolbars=no,width=700,height=500,left=20,top=20')
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files_setup()
//
///////////////////////////////////////////////////////////////////////////////////////////////

function Files_setup(){
 Images=FolderView.Images;
 if(Browser.nn4)FilesDoc=document.layers[Files_RootTagId];
 else if(Browser.nn6)FilesDoc=document.getElementById(Files_RootTagId);
 else FilesDoc=document.all[Files_RootTagId];
 FilesDoc.clear=Files_clear;
 FilesDoc.append=Files_append;
 FilesDoc.close=Files_close;
 FolderView.RootDrive.obj.view(0,true)
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files_append(content)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function Files_append(content){
 if(Browser.nn4){
  FilesDoc.document.writeln(content)
 }else{
  FilesDoc.innerHTML+=content
 }
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files_clear()
//
///////////////////////////////////////////////////////////////////////////////////////////////

function Files_clear(){
 if(Browser.nn4){
  FilesDoc.document.clear();
  FilesDoc.document.open()
 }else FilesDoc.innerHTML='';
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files_close()
//
///////////////////////////////////////////////////////////////////////////////////////////////

function Files_close(){
 if(Browser.nn4)FilesDoc.document.close()
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  Files_showFolder(index,id)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function Files_showFolder(index,id){
 var RootDrive=FolderView.RootDrive;
 var open=RootDrive.objs[index].expanded;
 RootDrive.obj.showFolder(index,open);
 var objFolders=RootDrive.objs;
 for(var i in objFolders){
  if(objFolders[i].id==id){
   objFolders[i].view(i);
   break
  }
 }
}

///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////