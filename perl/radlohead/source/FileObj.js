///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////
//
//  FileObj.js
//
///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////

var FileObj_IDS=0;
var FileObj_Objs=new Array();

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  FileObj(content,target)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function FileObj(content,target){
 this.styleClass='Folder';
 this.content=(content==null)?'':'<td class="'+this.styleClass+'">'+content+'</td>';
 this.target=(target==null)?document:target;
 this.id='FileObj'+FileObj_IDS++;
 this.built=false;
 this.getId=new Function('return this.id');
 this.addContent=FileObj_addContent;
 this.build=FileObj_build;
 this.setPos=FileObj_setPos;
 this.setVisible=FileObj_setVisible;
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  FileObj_addContent(content)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function FileObj_addContent(content){
 if(!this.built)this.content+='<td valign="bottom" class="'+this.styleClass+'">'+content+'</td>';
  else alert('FileObjError: Unable to add content to '+this.id+': Object Already Built');
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  FileObj_build()
//
///////////////////////////////////////////////////////////////////////////////////////////////

function FileObj_build(){
 var tag=(Browser.nn4)?'layer':'div';
 var opFix=(Browser.op5)?'style="position:absolute;"':'';
 this.target.writeln('<'+tag+' '+opFix+' id="'+this.id+'"><table cellpadding="0" cellspacing="0" border="0"><tr>'
                     +this.content+'</tr></table></'+tag+'>');
 this.built=true;
 FileObj_Objs.push(this)
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  FileObj_setPos(x,y)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function FileObj_setPos(x,y){
 if(Browser.nn4){
  var objDoc=document.layers[this.id];
  objDoc.moveTo(x,y)
 }else if(Browser.nn6){
  var objDoc=document.getElementById(this.id);
  objDoc.position='absolute';
  objDoc.left=x+'px';
  objDoc.top=y+'px'
 }else if(Browser.op5){
  var objDoc=document.all[this.id];
  objDoc.style.left=x;
  objDoc.style.top=y;
 }else if(Browser.ie4||Browser.ie5){
  var objDoc=document.all[this.id];
  objDoc.style.position='absolute';
  objDoc.style.pixelLeft=x;
  objDoc.style.pixelTop=y
 }
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  FileObj_setVisible(isVisible)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function FileObj_setVisible(isVisible){
 var visibility=(isVisible)?'visible':'hidden';
 if(Browser.nn4){
  var objDoc=document.layers[this.id];
  objDoc.visibility=visibility
 }else{
  var objDoc=(Browser.nn6)?document.getElementById(this.id):document.all[this.id];
  objDoc.style.visibility=visibility;
 }
}

///////////////////////////////////////////////////////////////////////////////////////////////
//
//  getFileObj(id)
//
///////////////////////////////////////////////////////////////////////////////////////////////

function getFileObj(id){
 for(var i in FileObj_Objs){
  var obj=FileObj_Objs[i];
  if(obj.id==id)return obj
 }
}

///////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////