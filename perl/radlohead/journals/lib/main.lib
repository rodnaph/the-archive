###############################################################################################
###############################################################################################
##
##  main.lib
##
###############################################################################################
###############################################################################################

use strict;
use FileHandle qw( getline print );

###############################################################################################

use constant J_DIR => BASE . 'journals/files/journals/';
use constant JOURNALS_FILE => BASE . 'journals/files/list.nfo';

###############################################################################################
##
##  has_journal( username ) : boolean
##
###############################################################################################

sub has_journal {

  my ( $username ) = @_;

  my $file = get_journals_file();
  if ( !-e $file ) {
    my $fh = new FileHandle( $file, '>' );
    $fh->print('');
  }

  my $fh = new FileHandle( $file );
  while( my $journal = $fh->getline() ) {
    chomp( $journal );
    if ( $journal =~ /^$username$/i ) { return 1; }
  }

  return 0;

}

###############################################################################################
##
##  get_journal_file( username ) : file
##
###############################################################################################

sub get_journal_file {

  my ( $username ) = @_;

  return J_DIR . URLEncode( $username );

}

###############################################################################################
##
##  get_journals_file()
##
###############################################################################################

sub get_journals_file {

  return JOURNALS_FILE;

}

###############################################################################################
##
##  get_journal_perms()
##
###############################################################################################

sub get_journal_perms {

  return 0666;

}

###############################################################################################

1;

###############################################################################################